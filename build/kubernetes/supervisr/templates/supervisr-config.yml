apiVersion: v1
data:
  docker.yml: |
    # Env for Docker images
    databases:
      default:
        engine: django.db.backends.mysql
        name: {{ .Values.config.databases.default.name }}
        user: {{ .Values.config.databases.default.user }}
        password: {{ .Values.config.databases.default.password }}
        host: mysql
        port: ''
        options:
          charset: UTF8MB4
          sql_mode: 'STRICT_TRANS_TABLES'
          init_command: "ALTER DATABASE {{ .Values.config.databases.default.name }} CHARACTER SET utf8 COLLATE utf8_unicode_ci;"
    redis: redis
    log:
      level:
          console: DEBUG
          file: DEBUG
      syslog:
          host: 127.0.0.1
          port: 514
      file:
          # File log can be disabled since we output everything to console anyways
          web: /dev/null
          task-runner: /dev/null
          task-scheduler: /dev/null
          task-monitor: /dev/null
    debug: false
    email:
      host: localhost
      port: 25
      user: ''
      password: ''
      use_tls: false
      use_ssl: false
      from: supervisr <supervisr@domain.tld>
    sentry: 'https://c5f3fa4e642d4dbfaa5db684bd0f6a13@sentry.services.beryju.org/6'
    http:
      default:
          listen: 0.0.0.0
          port: 8000
          threads: 30
    footer:
      # - text: ''
      #   view: ''
      #   url: ''
    secret_key: {{ .Values.config.secret_key }}
    domains:
      - {{ .Values.host }}
    timezone: UTC
    installed_apps:
      - supervisr.puppet
      - supervisr.dns
      - supervisr.mod.provider.nix_dns
      - supervisr.mod.provider.debug
      - supervisr.mail
      - supervisr.static
      - supervisr.mod.web_proxy
      - supervisr.mod.beacon
      - supervisr.mod.auth.ldap
      - supervisr.mod.auth.saml.idp
      - supervisr.mod.auth.oauth.provider
      - supervisr.mod.auth.oauth.client
      - supervisr.mod.tfa
      - supervisr.mod.stats.influx
      - supervisr.mod.provider.libcloud
kind: ConfigMap
metadata:
  name: {{ include "supervisr.name" . }}-config
